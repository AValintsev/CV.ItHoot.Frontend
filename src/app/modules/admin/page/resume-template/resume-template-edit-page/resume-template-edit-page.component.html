<div *ngIf="template" class="html-template">

  <form [formGroup]="templateForm" novalidate (ngSubmit)="submit()">

    <mat-form-field appearance="fill">
      <mat-label>Template name</mat-label>
      <input matInput formControlName="name">
      <mat-error *ngIf="templateForm.controls['name'].invalid && templateForm.controls['name'].touched">Template name is
        required</mat-error>
    </mat-form-field>

    <div>
      <mat-label>Docx file</mat-label>
      <input type="file" formControlName="docxFile"
        accept="application/vnd.openxmlformats-officedocument.wordprocessingml.document"
        (change)="onFileChange($event)" />
      <a mat-stroked-button color="primary" (click)="downloadDocxTemplate(template)">Download docx template</a>
      <mat-error *ngIf="templateForm.controls['docxFile'].invalid && templateForm.controls['docxFile'].touched">Docx
        file is required or file type is wrong</mat-error>
    </div>
    <a href="/assets/files/docx_template_instructions.pdf" target="_blank" download="docx_template_instructions.pdf">Download instruction to create docx
      template</a>

    <div>
      <mat-label>HTML template</mat-label>
      <div style="height: 50vh">
        <ngx-monaco-editor style="height: 100%" [options]="editorOptions" formControlName="html"
          (onInit)="onInit($event)"></ngx-monaco-editor>
      </div>
      <mat-error *ngIf="templateForm.controls['html'].invalid && templateForm.controls['html'].touched">HTML template is
        required</mat-error>
    </div>

    <mat-error *ngIf="isServerError">{{serverErrorMsg}}</mat-error>

    <div mat-dialog-actions class="actions">
      <a mat-raised-button (click)="viewTemplate()"
         matTooltip="View template" matTooltipPosition="above">View template</a>
      <button mat-raised-button cdkFocusInitial [disabled]="templateForm.invalid"
              matTooltip="Update template" matTooltipPosition="above">Update template</button>
    </div>

  </form>
</div>
